<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cine Viewer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <h1 class="splash-title">Cine Viewer</h1>
            <p class="splash-creator">Created by Reid Petro</p>
            <p class="splash-version">Version {{ version }}</p>
        </div>
    </div>

    <div class="container">
        <!-- Sidebar Controls -->
        <aside class="sidebar">
            <div class="logo">
                <h1>Cine Viewer</h1>
                <p class="subtitle">v{{ version }} - <a href="https://www.reidpetro.com" target="_blank" rel="noopener noreferrer">Reid Petro</a></p>
            </div>

            <!-- File Upload -->
            <div class="control-section">
                <button id="openImageBtn" class="btn">Open Image</button>
                <input type="file" id="fileInput" accept="image/*" style="display: none;">
            </div>

            <div style="margin: 15px 0;"></div>

            <!-- Center Cross -->
            <div class="control-section">
                <button id="centerBtn" class="btn" disabled>Center Markers</button>
                <div class="sub-controls" id="centerControls" style="display: none;">
                    <button class="sub-btn" data-center-type="standard">Standard</button>
                    <button class="sub-btn" data-center-type="small" style="background-color: #4CAF50; color: white;">Small</button>
                    <button class="sub-btn" data-center-type="square">Square</button>
                </div>
            </div>

            <!-- Thirds Grid -->
            <div class="control-section">
                <button id="thirdsBtn" class="btn" disabled>Thirds Grid</button>
                <div class="slider-control" id="thirdsControls" style="display: none;">
                    <label for="thirdsSlider">Line Thickness:</label>
                    <input type="range" id="thirdsSlider" min="1" max="5" value="1">
                    <span id="sliderValue">1</span>
                </div>
            </div>

            <!-- Aspect Ratios -->
            <div class="control-section">
                <button id="aspectRatioBtn" class="btn" disabled>Aspect Ratios</button>
                <div class="sub-controls" id="aspectRatioControls" style="display: none;">
                    <button class="sub-btn active-sub-btn" data-aspect-type="original">Original (<span id="aspectRatioButtonText">-</span>)</button>
                    <button class="sub-btn" data-aspect-type="16:9">16:9 - Widescreen</button>
                    <button class="sub-btn" data-aspect-type="9:16">9:16 - Vertical</button>
                    <button class="sub-btn" data-aspect-type="1:1">1:1 - Square</button>
                    <button class="sub-btn" data-aspect-type="2:1">2:1 - Streaming</button>
                    <button class="sub-btn" data-aspect-type="2.35:1">2.35:1 - Anamorphic widescreen</button>
                    <button class="sub-btn" data-aspect-type="4:3">4:3 - Classic TV</button>
                </div>
            </div>

            <div style="margin: 15px 0;"></div>

            <!-- False Color -->
            <div class="control-section">
                <button id="falsecolorBtn" class="btn" disabled>False Color</button>
                <div class="sub-controls" id="falsecolorControls" style="display: none;">
                    <button class="sub-btn" data-fc-type="ARRI" style="background-color: #4CAF50; color: white;">ARRI / Canon</button>
                    <button class="sub-btn" data-fc-type="Sony">Sony</button>
                    <button class="sub-btn" data-fc-type="Blackmagic">Blackmagic</button>
                </div>
            </div>

            <!-- Vectorscope -->
            <div class="control-section">
                <button id="vectorscopeBtn" class="btn" disabled>Vectorscope</button>
            </div>

            <!-- Color Palette -->
            <div class="control-section">
                <button id="paletteBtn" class="btn" disabled>Color Palette</button>
            </div>

            <div class="sidebar-bottom">
                <!-- Feedback Button -->
                <div class="control-section">
                    <button id="feedbackBtn" class="btn feedback-btn">About</button>
                </div>

                <!-- Image Info -->
                <div class="info-section">
                    <h3>Image Information</h3>
                    <p>Resolution: <span id="resolutionInfo">-</span></p>
                    <p>Aspect Ratio: <span id="aspectRatioInfo">-</span></p>
                    <p>Contrast Ratio: <span id="contrastRatioInfo">-</span></p>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Image and Vectorscope Wrapper -->
            <div class="image-vectorscope-wrapper">
                <!-- Color Palette -->
                <div class="palette-container" id="paletteContainer" style="display: none;">
                    <div class="palette-swatch" data-index="0"></div>
                    <div class="palette-swatch" data-index="1"></div>
                    <div class="palette-swatch" data-index="2"></div>
                    <div class="palette-swatch" data-index="3"></div>
                    <div class="palette-swatch" data-index="4"></div>
                    <div class="palette-swatch" data-index="5"></div>
                    <div class="palette-swatch" data-index="6"></div>
                    <div class="palette-swatch" data-index="7"></div>
                </div>

                <!-- Image Display -->
                <div class="image-container">
                    <canvas id="imageCanvas" class="image-canvas"></canvas>
                    <div class="placeholder" id="placeholder">
                        <p>Select - Open Image - to get started</p>
                    </div>
                    <div class="loading-spinner" id="loadingSpinner" style="display: none;">
                        <div class="spinner"></div>
                    </div>
                </div>

                <!-- Vectorscope -->
                <div class="vectorscope-container" id="vectorscopeContainer" style="display: none;">
                    <canvas id="vectorscopeCanvas" class="vectorscope-canvas"></canvas>
                </div>
            </div>

            <!-- Histogram -->
            <div class="histogram-container">
                <canvas id="histogramCanvas" class="histogram-canvas"></canvas>
            </div>

            <!-- False Color Legend -->
            <div class="legend-container" id="legendContainer" style="display: none;">
                <canvas id="legendCanvas" class="legend-canvas"></canvas>
            </div>
        </main>
    </div>

    <!-- Feedback Modal -->
    <div id="feedbackModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Privacy, Feedback, and Bug Reports</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <h4>About Cine Viewer</h4>
                <p>
                    Cine Viewer is a lightweight web-based tool designed for cinematographers, colorists, and visual artists to analyze and 
                    evaluate images. It provides essential tools including histograms, vectorscopes, false color, color palettes, and framing 
                    guides to help you make informed creative decisions. Whether you're grading footage or planning your next shot, Cine Viewer 
                    gives you professional-grade analysis tools in a simple, accessible interface. Created by <a href="https://www.reidpetro.com" target="_blank" rel="noopener noreferrer">Reid Petro</a>.
                </p>

                <h4 style="margin-top: 22px;">Feedback &amp; Bug Reports</h4>
                <p>We are always looking for feedback and issues to report. Please visit our GitHub Issues page to:</p>
                <ul>
                    <li>Report bugs or problems</li>
                    <li>Request new features</li>
                    <li>Share feedback and suggestions</li>
                </ul>
                <div class="github-link-container">
                    <a href="https://github.com/RetroVisuals/cine-viewer/issues" target="_blank" rel="noopener noreferrer" class="github-link">
                        Visit GitHub Repo
                    </a>
                </div>

                <h4 style="margin-top: 22px;">Privacy</h4>
                <p>
                    When you open an image, it is uploaded to the Cine Viewer server so it can generate tools like the histogram,
                    vectorscope, false color, and palette. By design, the app does not send your image(s) to any third-party services.
                </p>
                <ul>
                    <li><strong>Primary risk:</strong> If you use a hosted instance you do not control, the host operator could theoretically access images while they are being processed.</li>
                    <li><strong>How the app reduces exposure:</strong> Images are processed in-memory and are not saved to disk by default.</li>
                    <li><strong>Retention:</strong> A temporary in-memory copy may be held for your session and is automatically cleared shortly after inactivity and during periodic cleanup.</li>
                    <li><strong>Best practice:</strong> For sensitive work, run Cine Viewer locally or on infrastructure you control, and use HTTPS when accessing it remotely.</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
